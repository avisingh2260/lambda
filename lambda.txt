import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DriverManagerDataSource;

public class DB2ToPostgreSQLTransfer {

  public static void main(String[] args) {
    // Create DB2 data source
    DriverManagerDataSource db2DataSource = new DriverManagerDataSource();
    db2DataSource.setDriverClassName("com.ibm.db2.jcc.DB2Driver");
    db2DataSource.setUrl("jdbc:db2://localhost:50000/DBNAME");
    db2DataSource.setUsername("DB2_USERNAME");
    db2DataSource.setPassword("DB2_PASSWORD");

    // Create PostgreSQL data source
    DriverManagerDataSource postgreDataSource = new DriverManagerDataSource();
    postgreDataSource.setDriverClassName("org.postgresql.Driver");
    postgreDataSource.setUrl("jdbc:postgresql://localhost:5432/DBNAME");
    postgreDataSource.setUsername("POSTGRE_USERNAME");
    postgreDataSource.setPassword("POSTGRE_PASSWORD");

    // Create JdbcTemplate instances for both data sources
    JdbcTemplate db2JdbcTemplate = new JdbcTemplate(db2DataSource);
    JdbcTemplate postgreJdbcTemplate = new JdbcTemplate(postgreDataSource);

    // Query data from DB2
    List<Map<String, Object>> data = db2JdbcTemplate.queryForList("SELECT * FROM TABLE_NAME");

    // Insert data into PostgreSQL
    for (Map<String, Object> row : data) {
      postgreJdbcTemplate.update(
        "INSERT INTO TABLE_NAME (COLUMN1, COLUMN2) VALUES (?, ?)",
        row.get("COLUMN1"),
        row.get("COLUMN2")
      );
    }

    System.out.println("Data transfer complete.");
  }

}
